
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>jquery选项卡滑动表单步骤填写个人信息提交表单</title>



<link rel="stylesheet" href="http://www.17sucai.com/preview/170/2013-07-19/78/css/style.css" type="text/css" media="screen"/>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
//http://www.17sucai.com/pins/demoshow/1433
$(function() {
	/*
	number of fieldsets
	*/
	var fieldsetCount = $('#formElem').children().length;
	
	/*
	current position of fieldset / navigation link
	*/
	var current 	= 1;
    
	/*
	sum and save the widths of each one of the fieldsets
	set the final sum as the total width of the steps element
	*/
	var stepsWidth	= 0;
    var widths 		= new Array();
	$('#steps .step').each(function(i){
        var $step 		= $(this);
		widths[i]  		= stepsWidth;
        stepsWidth	 	+= $step.width();
    });
	$('#steps').width(stepsWidth);
	
	/*
	to avoid problems in IE, focus the first input of the form
	*/
	$('#formElem').children(':first').find(':input:first').focus();	
	
	/*
	show the navigation bar
	*/
	$('#navigation').show();
	
	/*
	when clicking on a navigation link 
	the form slides to the corresponding fieldset
	*/
    $('#navigation a').bind('click',function(e){
		var $this	= $(this);
		var prev	= current;
		$this.closest('ul').find('li').removeClass('selected');
        $this.parent().addClass('selected');
		/*
		we store the position of the link
		in the current variable	
		*/
		current = $this.parent().index() + 1;
		/*
		animate / slide to the next or to the corresponding
		fieldset. The order of the links in the navigation
		is the order of the fieldsets.
		Also, after sliding, we trigger the focus on the first 
		input element of the new fieldset
		If we clicked on the last link (confirmation), then we validate
		all the fieldsets, otherwise we validate the previous one
		before the form slided
		*/
        $('#steps').stop().animate({
            marginLeft: '-' + widths[current-1] + 'px'
        },500,function(){
			if(current == fieldsetCount)
				validateSteps();
			else
				validateStep(prev);
			$('#formElem').children(':nth-child('+ parseInt(current) +')').find(':input:first').focus();	
		});
        e.preventDefault();
    });
	
	/*
	clicking on the tab (on the last input of each fieldset), makes the form
	slide to the next step
	*/
	$('#formElem > fieldset').each(function(){
		var $fieldset = $(this);
		$fieldset.children(':last').find(':input').keydown(function(e){
			if (e.which == 9){
				$('#navigation li:nth-child(' + (parseInt(current)+1) + ') a').click();
				/* force the blur for validation */
				$(this).blur();
				e.preventDefault();
			}
		});
	});
	
	/*
	validates errors on all the fieldsets
	records if the Form has errors in $('#formElem').data()
	*/
	function validateSteps(){
		var FormErrors = false;
		for(var i = 1; i < fieldsetCount; ++i){
			var error = validateStep(i);
			if(error == -1)
				FormErrors = true;
		}
		$('#formElem').data('errors',FormErrors);	
	}
	
	/*
	validates one fieldset
	and returns -1 if errors found, or 1 if not
	*/
	function validateStep(step){
		if(step == fieldsetCount) return;
		
		var error = 1;
		var hasError = false;
		$('#formElem').children(':nth-child('+ parseInt(step) +')').find(':input:not(button)').each(function(){
			var $this 		= $(this);
			var valueLength = jQuery.trim($this.val()).length;
			
			if(valueLength == ''){
				hasError = true;
				$this.css('background-color','#FFEDEF');
			}
			else
				$this.css('background-color','#FFFFFF');	
		});
		var $link = $('#navigation li:nth-child(' + parseInt(step) + ') a');
		$link.parent().find('.error,.checked').remove();
		
		var valclass = 'checked';
		if(hasError){
			error = -1;
			valclass = 'error';
		}
		$('<span class="'+valclass+'"></span>').insertAfter($link);
		
		return error;
	}
	
	/*
	if there are errors don't allow the user to submit
	*/
	$('#registerButton').bind('click',function(){
		if($('#formElem').data('errors')){
			alert('请更正错误的表单。');
			return false;
		}	
	});
});

</script>
</head>

<body>


	<div id="wrapper">
		<div id="steps">
			<form id="formElem" name="formElem" action="" method="post">
				<div class="step">
					<h3>账号</h3>
					<p>
						<label for="username">用户名</label>
						<input id="username" name="username" />
					</p>
					<p>
						<label for="email">邮箱</label>
						<input id="email" name="email" placeholder="info@tympanus.net" type="email" AUTOCOMPLETE=OFF />
					</p>
					<p>
						<label for="password">密码</label>
						<input id="password" name="password" type="password" AUTOCOMPLETE=OFF />
					</p>
				</div>
				<div class="step">
					<h3>个人信息</h3>
					<p>
						<label for="name">姓名</label>
						<input id="name" name="name" type="text" AUTOCOMPLETE=OFF />
					</p>
					<p>
						<label for="country">国籍</label>
						<input id="country" name="country" type="text" AUTOCOMPLETE=OFF />
					</p>
					<p>
						<label for="phone">手机</label>
						<input id="phone" name="phone" placeholder="e.g. +351215555555" type="tel" AUTOCOMPLETE=OFF />
					</p>
					<p>
						<label for="website">个人网站</label>
						<input id="website" name="website" placeholder="e.g. http://www.codrops.com" type="tel" AUTOCOMPLETE=OFF />
					</p>
				</div>
				<div class="step">
					<h3>付款方式</h3>
					<p>
						<label for="cardtype">信用卡</label>
						<select id="cardtype" name="cardtype">
							<option>Visa</option>
							<option>Mastercard</option>
							<option>American Express</option>
						</select>
					</p>
					<p>
						<label for="cardnumber">信用卡号</label>
						<input id="cardnumber" name="cardnumber" type="number" AUTOCOMPLETE=OFF />
					</p>
					<p>
						<label for="secure">安全码</label>
						<input id="secure" name="secure" type="number" AUTOCOMPLETE=OFF />
					</p>
					<p>
						<label for="namecard">持卡人姓名</label>
						<input id="namecard" name="namecard" type="text" AUTOCOMPLETE=OFF />
					</p>
				</div>
				<div class="step">
					<h3>设置</h3>
					<p>
						<label for="newsletter">时事通讯</label>
						<select id="newsletter" name="newsletter">
							<option value="Daily" selected>每天的</option>
							<option value="Weekly">每周的</option>
							<option value="Monthly">每月的</option>
							<option value="Never">从来不</option>
						</select>
					</p>
					<p>
						<label for="updates">更新内容</label>
						<select id="updates" name="updates">
							<option value="1" selected>Package 1</option>
							<option value="2">Package 2</option>
							<option value="0">Don't send updates</option>
						</select>
					</p>
					<p>
						<label for="tagname">通讯标签</label>
						<input id="tagname" name="tagname" type="text" AUTOCOMPLETE=OFF />
					</p>
				</div>
				<div class="step">
					<h3>确认</h3>
					<p>一切形式正确填写如果所有的步骤有一个绿色的对号图标。一个红色的对号图标表明，一些领域遗失或填写无效数据。在这种最后一步，用户可以确认提交的形式。</p>
					<p class="submit">
						<button id="registerButton" type="submit">完成注册</button>
					</p>
				</div>
			</form>
		</div>
		<div id="navigation" style="display:none;">
			<ul>
				<li class="selected">
					<a href="#">账号</a>
				</li>
				<li>
					<a href="#">个人信息</a>
				</li>
				<li>
					<a href="#">付款方式</a>
				</li>
				<li>
					<a href="#">设置</a>
				</li>
				<li>
					<a href="#">确认</a>
				</li>
			</ul>
		</div>
	</div>

</body>
</html>
